# /etc/netscope/ascii_art.py

ascii_art_dict = {
    "Arch Linux": [
        "                   -`                  ",
        "                  .o+`                 ",
        "                 `ooo/                 ",
        "                `+oooo:                ",
        "               `+oooooo:               ",
        "               -+oooooo+:              ",
        "             `/:-:++oooo+:             ",
        "            `/++++/+++++++:            ",
        "           `/++++++++++++++:           ",
        "          `/+++ooooooooooooo/`         ",
        "         ./ooosssso++osssssso+`        ",
        "        .oossssso-````/ossssss+`       ",
        "       -osssssso.      :ssssssso.      ",
        "      :osssssss/        osssso+++.     ",
        "     /ossssssss/        +ssssooo/-     ",
        "   `/ossssso+/:-        -:/+osssso+-   ",
        "  `+sso+:-`                 `.-/+oso:  ",
        " `++:.                           `-/+/ ",
        " .`                                 `/"
    ],
    "Darwin": [
        "                      ,xNMM.",
        "                    .OMMMMo",
        "                    OMMM0,",
        "          .;loddo:' loolloddol;.",
        "        cKMMMMMMMMMMNWMMMMMMMMMM0:",
        "      .KMMMMMMMMMMMMMMMMMMMMMMMWd.",
        "      XMMMMMMMMMMMMMMMMMMMMMMMX.",
        "     ;MMMMMMMMMMMMMMMMMMMMMMMM:",
        "     :MMMMMMMMMMMMMMMMMMMMMMMM:",
        "     .MMMMMMMMMMMMMMMMMMMMMMMX.",
        "      kMMMMMMMMMMMMMMMMMMMMMMMMWd.",
        "      .XMMMMMMMMMMMMMMMMMMMMMMMMMMk",
        "       .XMMMMMMMMMMMMMMMMMMMMMMMMK.",
        "         kMMMMMMMMMMMMMMMMMMMMMMd",
        "          ;KMMMMMMMWXXWMMMMMMMk.",
        "            .cooc,.    .,coo:."
    ],
    "Debian": [
        "              _,met$$$$$gg.                ",
        "          ,g$$$$$$$$$$$$$$$P.              ",
        "        ,g$$P\"        \"\"\"Y$$.\".            ",
        "       ,$$P'               `$$$.           ",
        "     ',$$P       ,ggs.     `$$b:           ",
        "     `d$$'     ,$P\"'   .    $$$            ",
        "      $$P      d$'     ,    $$P            ",
        "      $$:      $$.   -    ,d$$'            ",
        "      $$;      Y$b._   _,d$P'              ",
        "      Y$$.    `.`\"Y$$$$P\"'                ",
        "      `$$b      \"-.__                     ",
        "       `Y$$                                 ",
        "        `Y$$.                               ",
        "          `$$b.                             ",
        "            `Y$$b.                          ",
        "               \"\"\"                          "
    ],
    "Elementary": [
        "         eeeeeeeeeeeeeeeee             ",
        "      eeeeeeeeeeeeeeeeeeeeeee          ",
        "    eeeee  eeeeeeeeeeee   eeeee        ",
        "  eeee   eeeee       eee     eeee      ",
        " eeee   eeee          eee     eeee     ",
        "eee    eee            eee       eee    ",
        "eee   eee            eee        eee    ",
        "ee    eee           eeee       eeee    ",
        "ee    eee         eeeee      eeeeee    ",
        "ee    eee       eeeee      eeeee ee    ",
        "eee   eeee   eeeeee      eeeee  eee    ",
        "eee    eeeeeeeeee     eeeeee    eee    ",
        " eeeeeeeeeeeeeeeeeeeeeeee    eeeee     ",
        "  eeeeeeee eeeeeeeeeeee      eeee      ",
        "    eeeee                 eeeee        ",
        "      eeeeeee         eeeeeee          ",
        "         eeeeeeeeeeeeeeeee             "
    ],
    "Fedora": [
        "               /:-------------:\\            ",
        "            :-------------------::           ",
        "          :-----------/shhOHbmp---:\\         ",
        "        /-----------omMMMNNNMMD  ---:\\       ",
        "       :-----------sMMMMNMNMP.    ---:       ",
        "      :-----------:MMMdP-------    ---\\      ",
        "     ,------------:MMMd--------    ---:      ",
        "     :------------:MMMd-------    .---:      ",
        "     :----    oNMMMMMMMMMNho     .----:      ",
        "     :--     .+shhhMMMmhhy++   .------/      ",
        "     :-    -------:MMMd--------------:       ",
        "     :-   --------/MMMd-------------;        ",
        "     :-    ------/hMMMy------------:         ",
        "     :-- :dMNdhhdNMMNo------------;          ",
        "     :---:sdNMMMMNds:------------:           ",
        "     :------:://:-------------::             ",
        "     :---------------------://               "
    ],
    "Kali": [
        "      ..............                                      ",
        "      ..,;:ccc,.                                          ",
        "    ......''';lxO.                                        ",
        ".....''''..........,:ld;                                 ",
        "     .';;;:::;,,.x,                                       ",
        "..'''.            0Xxoc:,.  ...                           ",
        "....                ,ONkc;,;cokOdc',.                     ",
        ".                   OMo           ':ddo.                  ",
        "                    dMc               :OO;                ",
        "                    0M.                 .:o.              ",
        "                    ;Wd                                   ",
        "                     ;XO,                                 ",
        "                       ,d0Odlc;,.                         ",
        "                           ..',;:cdOOd::,.                ",
        "                                    .:d;.':;.             ",
        "                                       'd,  .'            ",
        "                                         ;l   ..          ",
        "                                          .o              ",
        "                                            c             ",
        "                                            .'            ",
        "                                             .            "
    ],
    "Manjaro": [
        "      ████████████████████  ████████    ",
        "      ████████████████████  ████████    ",
        "      ████████████████████  ████████    ",
        "      ████████████████████  ████████    ",
        "      ████████            ████████    ",
        "      ████████  ████████  ████████    ",
        "      ████████  ████████  ████████    ",
        "      ████████  ████████  ████████    ",
        "      ████████  ████████  ████████    ",
        "      ████████  ████████  ████████    ",
        "      ████████  ████████  ████████    ",
        "      ████████  ████████  ████████    "
    ],
    "Mint": [
        "              ...-:::::-...                  ",
        "           .-MMMMMMMMMMMMMMM-.               ",
        "       .-MMMM`..-:::::::-..`MMMM-.           ",
        "     .:MMMM.:MMMMMMMMMMMMMMM:.MMMM:.         ",
        "    -MMM-M---MMMMMMMMMMMMMMMMMMM.MMM-        ",
        "  `:MMM:MM`  :MMMM:....::-...-MMMM:MMM:`     ",
        "  :MMM:MMM`  :MM:`  ``    ``  `:MMM:MMM:     ",
        " .MMM.MMMM`  :MM.  -MM.  .MM-  `MMMM.MMM.    ",
        " :MMM:MMMM`  :MM.  -MM-  .MM:  `MMMM-MMM:    ",
        " :MMM:MMMM`  :MM.  -MM-  .MM:  `MMMM:MMM:    ",
        " :MMM:MMMM`  :MM.  -MM-  .MM:  `MMMM-MMM:    ",
        " .MMM.MMMM`  :MM:--:MM:--:MM:  `MMMM.MMM.    ",
        "  :MMM:MMM-  `-MMMMMMMMMMMM-`  -MMM-MMM:     ",
        "   :MMM:MMM:`                `:MMM:MMM:      ",
        "    .MMM.MMMM:--------------:MMMM.MMM.       ",
        "      '-MMMM.-MMMMMMMMMMMMMMM-.MMMM-'        ",
        "        '.-MMMM``--:::::--``MMMM-.'          ",
        "             '-MMMMMMMMMMMMM-'               ",
        "                ``-:::::-``                  "
    ],
    "Red Hat": [
        "               .MMM..:MMMMMMM                     ",
        "              MMMMMMMMMMMMMMMMMM                  ",
        "              MMMMMMMMMMMMMMMMMMMM.               ",
        "             MMMMMMMMMMMMMMMMMMMMMM               ",
        "            ,MMMMMMMMMMMMMMMMMMMMMM:              ",
        "            MMMMMMMMMMMMMMMMMMMMMMMM              ",
        "      .MMMM'  MMMMMMMMMMMMMMMMMMMMMM              ",
        "     MMMMMM    `MMMMMMMMMMMMMMMMMMMM.             ",
        "    MMMMMMMM      MMMMMMMMMMMMMMMMMM .            ",
        "    MMMMMMMMM.       `MMMMMMMMMMMMM' MM.          ",
        "    MMMMMMMMMMM.                     MMMM         ",
        "    `MMMMMMMMMMMMM.                 ,MMMMM.       ",
        "     `MMMMMMMMMMMMMMMMM.          ,MMMMMMMM.      ",
        "        MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM      ",
        "          MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:      ",
        "             MMMMMMMMMMMMMMMMMMMMMMMMMMMMMM       ",
        "                `MMMMMMMMMMMMMMMMMMMMMMMM:        ",
        "                    ``MMMMMMMMMMMMMMMMM'          "
    ],
    "Slackware": [
        "                       ::::::::                 ",
        "                 :::::::::::::::::::            ",
        "              :::::::::::::::::::::::::         ",
        "            ::::::::cllcccccllllllll::::::      ",
        "         :::::::::lc               dc:::::::    ",
        "        ::::::::cl   clllccllll    oc:::::::::  ",
        "       :::::::::o   lc::::::::co   oc:::::::::: ",
        "      ::::::::::o    cccclc:::::clcc::::::::::: ",
        "      :::::::::::lc        cclccclc:::::::::::: ",
        "     ::::::::::::::lcclcc          lc:::::::::::",
        "     ::::::::::cclcc:::::lccclc     oc::::::::::",
        "     ::::::::::o    l::::::::::l    lc::::::::::",
        "      :::::cll:o     clcllcccll     o:::::::::::",
        "      :::::occ:o                  clc:::::::::::",
        "       ::::ocl:ccslclccclclccclclc::::::::::::: ",
        "        :::oclcccccccccccccllllllllllllll:::::  ",
        "         ::lcc1lcccccccccccccccccccccccco::::   ",
        "           ::::::::::::::::::::::::::::::::     ",
        "             ::::::::::::::::::::::::::::       ",
        "                ::::::::::::::::::::::          ",
        "                     ::::::::::::               "
    ],
    "Ubuntu": [
        "              .-/+oossssoo+/-.               ",
        "          `:+ssssssssssssssssss+:`           ",
        "        -+ssssssssssssssssssyyssss+-         ",
        "      .ossssssssssssssssssdMMMNysssso.       ",
        "     /ssssssssssshdmmNNmmyNMMMMhssssss/      ",
        "    +ssssssssshmydMMMMMMMNddddyssssssss+     ",
        "   /sssssssshNMMMyhhyyyyhmNMMMNhssssssss/    ",
        "  .ssssssssdMMMNhsssssssssshNMMMdssssssss.   ",
        "  +sssshhhyNMMNyssssssssssssyNMMMysssssss+   ",
        "  ossyNMMMNyMMhsssssssssssssshmmmhssssssso   ",
        "  ossyNMMMNyMMhsssssssssssssshmmmhssssssso   ",
        "  +sssshhhyNMMNyssssssssssssyNMMMysssssss+   ",
        "  .ssssssssdMMMNhsssssssssshNMMMdssssssss.   ",
        "   /sssssssshNMMMyhhyyyyhdNMMMNhssssssss/    ",
        "    +sssssssssdmydMMMMMMMMddddyssssssss+     ",
        "     /ssssssssssshdmNNNNmyNMMMMhssssss/      ",
        "      .ossssssssssssssssssdMMMNysssso.       ",
        "        -+sssssssssssssssssyyyssss+-         ",
        "          `:+ssssssssssssssssss+:`           ",
        "              .-/+oossssoo+/-.               "
    ],
    "Ubuntu Budgie": [
        "                ./oydmMMMMMMmdyo/.      ",
        "             :smMMMMMMMMMMMhs+:++yhs:   ",
        "          `omMMMMMMMMMMMN+`        `odo`",
        "         /NMMMMMMMMMMMMN-            `sN/",
        "       `hMMMMmhhmMMMMMMh               sMh`",
        "      .mMmo-     /yMMMMm`              `MMm.",
        "      mN/       yMMMMMMMd-              MMMm",
        "     oN-        oMMMMMMMMMms+//+o+:    :MMMMo",
        "     m/          +NMMMMMMMMMMMMMMMMm. :NMMMMm",
        "     M`           .NMMMMMMMMMMMMMMMNodMMMMMMM",
        "     M-            sMMMMMMMMMMMMMMMMMMMMMMMMM",
        "     mm`           mMMMMMMMMMNdhhdNMMMMMMMMMm",
        "     oMm/        .dMMMMMMMMh:      :dMMMMMMMo",
        "      mMMNyo/:/sdMMMMMMMMM+          sMMMMMm",
        "      .mMMMMMMMMMMMMMMMMMs           `NMMMm.",
        "       `hMMMMMMMMMMM.oo+.            `MMMh`",
        "         /NMMMMMMMMMo                sMN/",
        "          `omMMMMMMMMy.            :dmo`",
        "             :smMMMMMMMh+-`   `.:ohs:",
        "                ./oydmMMMMMMdhyo/."
    ]
}

# -----------------------------------------------------------------------------
# Theme-aware color metadata & helpers
# -----------------------------------------------------------------------------

PAIR_HINT = {'fg':1, 'accent':2, 'accent2':5, 'accent3':6, 'accent4':7, 'accent5':8, 'muted':9}

# Enhanced color policies based on screenfetch/neofetch brand colors
ASCII_COLOR_POLICY = {
    'darwin': {'mode': 'stripe', 'palette_order': ['accent3','accent','accent2','accent2','accent5','accent4']},  # Apple rainbow
    'slackware': {'mode': 'stripe', 'palette_order': ['accent4','fg','accent4','fg','accent4','fg']},  # Blue/white alternating
    'arch linux': {'mode': 'stripe', 'palette_order': ['accent4','accent','accent4','accent','accent4','accent']},  # Cyan/blue gradient
    'ubuntu': {'mode': 'stripe', 'palette_order': ['accent2','fg','accent2','fg','accent2','fg']},  # Orange/white pattern  
    'ubuntu budgie': {'mode': 'stripe', 'palette_order': ['accent4','accent','accent4','accent','accent4','accent']},  # Blue gradient
    'debian': {'mode': 'flat', 'color': 'accent2'},  # Red Debian swirl
    'fedora': {'mode': 'stripe', 'palette_order': ['accent4','fg','accent4','fg','accent4','fg']},  # Blue/white pattern
    'opensuse': {'mode': 'stripe', 'palette_order': ['accent3','fg','accent3','fg','accent3','fg']},  # Green/white
    'mint': {'mode': 'stripe', 'palette_order': ['accent3','fg','accent3','fg','accent3','fg']},  # Mint green/white
    'manjaro': {'mode': 'stripe', 'palette_order': ['accent3','fg','accent3','fg','accent3','fg']},  # Green/white
    'gentoo': {'mode': 'stripe', 'palette_order': ['accent5','fg','accent5','fg','accent5','fg']},  # Purple/white
    'kali': {'mode': 'stripe', 'palette_order': ['accent4','fg','accent4','fg','accent4','fg']},  # Blue/white dragon
    'elementary': {'mode': 'stripe', 'palette_order': ['accent4','fg','accent4','fg','accent4','fg']},  # Blue/white gradient
    'red hat': {'mode': 'stripe', 'palette_order': ['accent2','fg','accent2','fg','accent2','fg']},  # Red/white
    'redhat': {'mode': 'stripe', 'palette_order': ['accent2','fg','accent2','fg','accent2','fg']},  # Red/white
    'rhel': {'mode': 'stripe', 'palette_order': ['accent2','fg','accent2','fg','accent2','fg']},  # Red/white
}

def _rstrip_lines(lines):
    """Trim trailing whitespace for consistent measuring; keep left padding intact."""
    return [ln.rstrip('\n').rstrip() for ln in lines]

def get_ascii(key: str):
    """Return normalized ASCII lines for a distro key (case-insensitive)."""
    if not key:
        return []
    # exact
    if key in ascii_art_dict:
        return _rstrip_lines(ascii_art_dict[key])
    # case-insensitive
    lk = key.lower()
    for k, v in ascii_art_dict.items():
        if k.lower() == lk:
            return _rstrip_lines(v)
    return []

def color_layers_for(key: str):
    """Return a list of (color_name, [lines]) for the given distro key.
    color_name ∈ {'fg','accent','accent2','accent3','accent4','accent5','muted'}
    """
    lines = get_ascii(key)
    if not lines:
        return []
    policy = ASCII_COLOR_POLICY.get(key.lower())
    if not policy:
        return [('accent', lines)]
    mode = policy.get('mode')
    if mode == 'flat':
        return [(policy.get('color', 'accent'), lines)]
    if mode == 'stripe':
        pal = policy.get('palette_order') or ['accent','accent2','accent3','accent4','accent5','muted']
        layered = []
        for i, ln in enumerate(lines):
            color = pal[i % len(pal)] if ln.strip() else 'fg'
            layered.append((color, [ln]))
        return layered
    return [('accent', lines)]

def center_block(lines, width=None):
    """Pad each line to a common width so the art block is visually centered.
    If width is None, uses the max visual width among lines.
    """
    if not lines:
        return []
    clean = _rstrip_lines(lines)
    w = width or max(len(ln) for ln in clean)
    return [ln.center(w) for ln in clean]

def centered_ascii(key: str, width=None):
    """Convenience: get centered lines for a given distro key."""
    return center_block(get_ascii(key), width=width)
